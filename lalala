p = 671 g = 2
(a = 358
b = 189) private
K = g^a mod p
K = g^b mod p
k = 2^358 mod 671
k = 2^189 mod 671
168 512
y = 512^358 mod 671
y = 168^189 mod 671
235 235

1) В контексте Диффи–Хеллмана «человек посередине» (Man-in-the-Middle, MITM) — это злоумышленник, 
который перехватывает и, при необходимости, изменяет сообщения между двумя сторонами, 
пытаясь вычислить или подменить общий секретный ключ, не будучи законным участником обмена.

2) Диффи–Хеллман работает, потому что оба вычисляют один и тот же ключ через свойства степеней. 
Независимо, кто возводит в степень чужого публичного числа, результат один и тот же.
